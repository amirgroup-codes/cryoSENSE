/usr/scratch/dtsui/.conda/pkgs/diffusion/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/usr/scratch/dtsui/.conda/pkgs/diffusion/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Using device: cuda
GPU: NVIDIA RTX A6000
Memory allocated: 0.00 GB
Memory reserved: 0.00 GB
Results will be saved to: results/EMPIAR10786_128/wavelet/block_2_masks_1_random_binary
Image size: 128x128
Block size: 2x2
Output size after downsampling: 64x64
Using mask type: random_binary
Noise level for measurements (sigma): 0.0
Creating 1 binary masks...
Processing CryoEM images from index 0 to 15
Total number of images to process: 16
Processing in batches of size: 16
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /usr/scratch/dtsui/.conda/pkgs/diffusion/lib/python3.10/site-packages/lpips/weights/v0.1/alex.pth

===== Processing Batch 1/1 =====
Batch image IDs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
Loading batch of CryoEM images...
DIRECTORY /usr/scratch/danial_stuff/FrugalCryo/Test/baselines/results/EMPIAR10786_128/selected_images.pt
Loading batch of CryoEM data from /usr/scratch/danial_stuff/FrugalCryo/Test/baselines/results/EMPIAR10786_128/selected_images.pt...
CryoEM data loaded successfully. Data shape: torch.Size([16, 128, 128])
Selected batch size: 16
Selected batch shape: torch.Size([16, 128, 128])
Batch normalized from [0, 1] to [-1, 1] range
DIRECTORY torch.Size([1, 128, 128])
Getting measurements from batch of original images...
Performing Wavelet Minimization...

----- Processing results for image 0 -----
PSNR: 18.37 dB, SSIM: 0.3351, MSE: 0.058178

----- Processing results for image 1 -----
PSNR: 17.93 dB, SSIM: 0.3668, MSE: 0.064398

----- Processing results for image 2 -----
PSNR: 17.68 dB, SSIM: 0.3503, MSE: 0.068272

----- Processing results for image 3 -----
PSNR: 17.89 dB, SSIM: 0.3432, MSE: 0.064986

----- Processing results for image 4 -----
PSNR: 18.29 dB, SSIM: 0.3514, MSE: 0.059293

----- Processing results for image 5 -----
PSNR: 18.47 dB, SSIM: 0.3564, MSE: 0.056937

----- Processing results for image 6 -----
PSNR: 18.26 dB, SSIM: 0.3596, MSE: 0.059690

----- Processing results for image 7 -----
PSNR: 18.29 dB, SSIM: 0.3354, MSE: 0.059261

----- Processing results for image 8 -----
PSNR: 17.82 dB, SSIM: 0.3399, MSE: 0.066120

----- Processing results for image 9 -----
PSNR: 18.01 dB, SSIM: 0.3569, MSE: 0.063248

----- Processing results for image 10 -----
PSNR: 18.18 dB, SSIM: 0.3382, MSE: 0.060804

----- Processing results for image 11 -----
PSNR: 18.54 dB, SSIM: 0.3614, MSE: 0.055963

----- Processing results for image 12 -----
PSNR: 18.37 dB, SSIM: 0.3592, MSE: 0.058227

----- Processing results for image 13 -----
PSNR: 17.81 dB, SSIM: 0.3551, MSE: 0.066168

----- Processing results for image 14 -----
PSNR: 18.02 dB, SSIM: 0.3384, MSE: 0.063085

----- Processing results for image 15 -----
PSNR: 18.08 dB, SSIM: 0.3571, MSE: 0.062168
Cleaned up memory after batch 1

===== Completed processing all 16 images =====
Results saved in the 'results/EMPIAR10786_128/wavelet/block_2_masks_1_random_binary' directory.
