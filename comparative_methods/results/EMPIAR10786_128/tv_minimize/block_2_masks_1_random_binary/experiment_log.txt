/usr/scratch/dtsui/.conda/pkgs/diffusion/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/usr/scratch/dtsui/.conda/pkgs/diffusion/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Using device: cuda
GPU: NVIDIA RTX A6000
Memory allocated: 0.00 GB
Memory reserved: 0.00 GB
Results will be saved to: results/EMPIAR10786_128/tv_minimize/block_2_masks_1_random_binary
Image size: 128x128
Block size: 2x2
Output size after downsampling: 64x64
Using mask type: random_binary
Noise level for measurements (sigma): 0.0
Creating 1 binary masks...
Processing CryoEM images from index 0 to 15
Total number of images to process: 16
Processing in batches of size: 16
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /usr/scratch/dtsui/.conda/pkgs/diffusion/lib/python3.10/site-packages/lpips/weights/v0.1/alex.pth

===== Processing Batch 1/1 =====
Batch image IDs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
Loading batch of CryoEM images...
DIRECTORY /usr/scratch/danial_stuff/FrugalCryo/Test/baselines/results/EMPIAR10786_128/selected_images.pt
Loading batch of CryoEM data from /usr/scratch/danial_stuff/FrugalCryo/Test/baselines/results/EMPIAR10786_128/selected_images.pt...
CryoEM data loaded successfully. Data shape: torch.Size([16, 128, 128])
Selected batch size: 16
Selected batch shape: torch.Size([16, 128, 128])
Batch normalized from [0, 1] to [-1, 1] range
DIRECTORY torch.Size([1, 128, 128])
Getting measurements from batch of original images...
Performing TV Minimization...

----- Processing results for image 0 -----
PSNR: 11.65 dB, SSIM: 0.1044, MSE: 0.273629

----- Processing results for image 1 -----
PSNR: 11.63 dB, SSIM: 0.1256, MSE: 0.274650

----- Processing results for image 2 -----
PSNR: 11.40 dB, SSIM: 0.1167, MSE: 0.289522

----- Processing results for image 3 -----
PSNR: 11.53 dB, SSIM: 0.1226, MSE: 0.281153

----- Processing results for image 4 -----
PSNR: 11.69 dB, SSIM: 0.1164, MSE: 0.271187

----- Processing results for image 5 -----
PSNR: 11.60 dB, SSIM: 0.1173, MSE: 0.276575

----- Processing results for image 6 -----
PSNR: 11.57 dB, SSIM: 0.1128, MSE: 0.278793

----- Processing results for image 7 -----
PSNR: 11.48 dB, SSIM: 0.1136, MSE: 0.284741

----- Processing results for image 8 -----
PSNR: 11.55 dB, SSIM: 0.1250, MSE: 0.279771

----- Processing results for image 9 -----
PSNR: 11.40 dB, SSIM: 0.1041, MSE: 0.289985

----- Processing results for image 10 -----
PSNR: 11.42 dB, SSIM: 0.1029, MSE: 0.288388

----- Processing results for image 11 -----
PSNR: 11.66 dB, SSIM: 0.1149, MSE: 0.272726

----- Processing results for image 12 -----
PSNR: 11.64 dB, SSIM: 0.1092, MSE: 0.274272

----- Processing results for image 13 -----
PSNR: 11.38 dB, SSIM: 0.1107, MSE: 0.291417

----- Processing results for image 14 -----
PSNR: 11.58 dB, SSIM: 0.1098, MSE: 0.278294

----- Processing results for image 15 -----
PSNR: 11.59 dB, SSIM: 0.1140, MSE: 0.277485
Cleaned up memory after batch 1

===== Completed processing all 16 images =====
Results saved in the 'results/EMPIAR10786_128/tv_minimize/block_2_masks_1_random_binary' directory.
